<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>民航机票代理市场系统</title>
<meta name="keywords"  content="设置关键词..." />
<meta name="description" content="设置描述..." />
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
<link rel="icon" href="images/icon/favicon.ico" type="image/x-icon">
<link rel="stylesheet" type="text/css" href="css/style.css" />
<script src="javascript/jquery.js"></script>
<script src="javascript/plug-ins/customScrollbar.min.js"></script>
<script src="javascript/plug-ins/echarts.min.js"></script>
<script src="javascript/plug-ins/layerUi/layer.js"></script>
<script src="javascript/plug-ins/pagination.js"></script>
<script src="javascript/public.js"></script>

<link rel="stylesheet" type="text/css" href="css/b.page.css">
<script type="text/javascript" href="javascript/b.page.js"></script>

<script type="text/javascript" src="javascript/echarts.min.js"></script>



<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" type="text/css" href="jQuerySelect/lib/css/htools.select.skin.css?v=1.0">

</head>
<body>
<div class="main-wrap">
	<div class="side-nav">
		<div class="side-logo">
			<div class="logo">
				<span class="logo-ico">
					<i class="i-l-1"></i>
					<i class="i-l-2"></i>
					<i class="i-l-3"></i>
				</span>
				<strong>民航机票代理市场系统</strong>
			</div>
		</div>
		
		<nav class="side-menu content mCustomScrollbar" data-mcs-theme="minimal-dark">
			<ul>
			<li>
				<dl>
					<dt>
						<i class="icon-dashboard"></i>销售基本信息<i class="icon-angle-right"></i>
					</dt>
					<dd>
							<a href="hanginf.html">航空公司</a>
					</dd>
					<dd>
							<a href="daiinf.html">代理人</a>
					</dd>
					</dl>
				</li>
				<li>
					<dl>
						<dt>
							<i class="icon-columns"></i>销售关系<i class="icon-angle-right"></i>
						</dt>
						<dd>
							<a href="flydiagram.html">航空公司</a>
						</dd>
						<dd>
							<a href="peoplediagram.html">代理人</a>
						</dd>
					</dl>
				</li>
				<li>
					<dl>
						<dt>
							<i class="icon-inbox"></i>销售趋势<i class="icon-angle-right"></i>
						</dt>
						<dd>
							<a href="sumchange.html">总体销售趋势</a>
						</dd>
						<dd>
							<a href="hangchange.html">航空公司</a>
						</dd>
						<dd>
							<a href="daichange.html">代理人</a>
						</dd>
						
					</dl>
				</li>
				<li>
					<dl>
						<dt>
							<i class="icon-twitter"></i>每日销售情况<i class="icon-angle-right"></i>
						</dt>
						<dd>
							<a href="everyhang.html">航空公司</a>
						</dd>
						<dd>
							<a href="everydai.html">代理人</a>
						</dd>
						
					</dl>
				</li>
				<li>
					<dl>
						<dt>
							<i class="icon-book"></i>市场地位<i class="icon-angle-right"></i>
						</dt>
						<dd>
							<a href="Sales_ability.html">销售能力</a>
						</dd>
						<dd>
							<a href="Cash_flow_force.html">资金周转力</a>
						</dd>
						<dd>
							<a href="active.html">活跃度</a>
						</dd>
						<dd>
							<a href="The_market_share.html">市场占有量</a>
						</dd>
					</dl>
				</li>
				<li>
					<dl>
						<dt>
							<i class="icon-star"></i>预测<i class="icon-angle-right"></i>
						</dt>
						<dd>
							<a href="hangpredict.html">航空公司</a>
						</dd>
						<dd>
							<a href="daipredict.html">代理人</a>
						</dd>
					</dl>
				</li>
				<li>
					<dl>
						<dt>
							<i class="icon-user"></i>个人中心<i class="icon-angle-right"></i>
						</dt>
						<dd>
							<a href="peocenter.html">个人基本信息</a>
						</dd>
						<dd>
							<a href="changeps.html">密码修改</a>
						</dd>
						
					</dl>
				</li>
			</ul>	
		</nav>
	</div>
	<div class="content-wrap">
		<header class="top-hd">
			<div class="hd-lt">
				<a class="icon-reorder"></a>
			</div>
			<div class="hd-rt">
				<ul>
					<li>
						<a href="javascript:void(0)" id="JsSignOut"><i class="icon-signout"></i>安全退出</a>
					</li>
				</ul>
			</div>
		</header>
		<main class="main-cont content mCustomScrollbar">
			<!--开始::内容-->
			<div class="page-wrap">
				<section class="page-hd">	
	<div class=" box9">
		<div class="main-box">
			<div class="_htools-selec-box">
				<label>请选择想要查询的日期：</label>
		        <label>
		            <select id="myselect" class="select" style="width: 100px;">
                    
                	</select>
		        </label>
		        <button id="get" style="width: 50px;height: 26px;" onclick="selectData()">
		            查询
		        </button>
		</div>	
		<div id="main" style="width: 100%;height: 520px;margin-top: 30px;" ></div>
		<div id="main1" style="width: 100%;height: 520px;margin-top: 30px;" ></div>
		</div>
	</div>
</div>
</section>
			<!--开始::结束-->
		</main>
		<footer class="btm-ft">
			<p class="clear">
				<span class="fl">©Copyright 2017 <a href="#"  target="_blank">北京工业大学信息学部（原软件学院）</a></span>
			</p>
		</footer>
	</div>
</div>
<script src="http://www.jq22.com/jquery/jquery-1.10.2.js"></script>
<script src="jQuerySelect/lib/js/jquery.htools.select.js"></script>
<script type="text/javascript">
	$(function(){
		loadData(1);
	});
	function selectData(){
		var day=$("#myselect").val();
		loadData(day);
		
	}
	function loadData(day){
		var params={"day":day};
		$.ajax({
			type:"post",
			url:"dayagent.action",
			data:params,
			dataType:"json",
			contentType:"application/x-www-form-urlencoded;charset=utf-8 ",
			success:function(data){
				var datainfo = JSON.parse(data.data);
				var maxsalecnt=Math.max.apply(null,datainfo.salecntlist)/5;
				var maxsaleround=parseFloat((Math.max.apply(null,datainfo.saleroundlist)/5+0.01).toFixed(2));
				var ysalecnt=(Math.ceil(maxsalecnt)==0?1:Math.ceil(maxsalecnt));
				var ysaleround=(maxsaleround==0?1:maxsaleround);
				
				var maxbuycnt=Math.max.apply(null,datainfo.buycntlist)/5;
				var maxbuyround=parseFloat((Math.max.apply(null,datainfo.buyroundlist)/5+0.01).toFixed(2));
				var ybuycnt=(Math.ceil(maxbuycnt)==0?1:Math.ceil(maxbuycnt));
				var ybuyround=(maxbuyround==0?1:maxbuyround);
				
				$("#myselect").html("");
				var content="";
				for(var i=1;i<=91;i++){
					if(i==day){
						content+="<option value="+i+" selected='selected'>"+i+"</option>";
					}else{
						content+="<option value="+i+">"+i+"</option>";
					}
				}
				$("#myselect").html(content);
				var myChart = echarts.init(document.getElementById('main'));
				var option = {
			        title:{
			         text:'代理人售票情况',
			         margin:20,
			         top:10,
			         left:'center',
			            textStyle: {
			            color: '#000',
			            fontStyle: 'normal',
			            fontFamily: '微软雅黑',
			            fontSize: 20,
			            margin:40,
			        }
			     },
			    tooltip: {
			        trigger: 'axis',
			        axisPointer: {type: 'cross'}
			    },
			    grid: {
		            right: '15%',
		            top:80
		           
		        },
			     dataZoom:[
			                    {   show:true,
			                        height:25,
			                        xAxisIndex: [0],
			                        bottom:10,
			                        type: 'slider',
			                        startValue: 0,
			                        endValue: 10,
			                        handleIcon: 'path://M306.1,413c0,2.2-1.8,4-4,4h-59.8c-2.2,0-4-1.8-4-4V200.8c0-2.2,1.8-4,4-4h59.8c2.2,0,4,1.8,4,4V413z',
			                        handleSize:'110%',
			                        handleStyle: {
			                            color:'#9B4E4E'
			                        }
			                     },
			                     {
			                         show:true,
			                         type: 'inside',
			                         height:15,
			                         startVaue: 0,
			                         endValue:10
			                     }
			                     ,
			                     {
			                         show: true,
			                         yAxisIndex: [0,1],
			                         filterMode: 'empty',
			                         width: 30,
			                         height: '70%',
			                         showDataShadow: false,
			                         right: '3%'
			                     }
			                    ],
			    toolbox: {
			        feature: {
			            dataView: {show: true, readOnly: false},
			            magicType: {show: true, type: ['line', 'bar']},
			            restore: {show: true},
			            saveAsImage: {show: true}
			        }
			    },
			    legend: {
			        left:20,
			        top:10,
			        data:['售票数量','售票金额']
			    },
			    xAxis: [
			        {
			            type: 'category',
			            data:datainfo.agentlist
			        }
			    ],
			    yAxis: [
			        {
			            type: 'value',
			            name: '数量(单位:张)',
			            min: 0,
			            max: ysalecnt*5,
			            interval:ysalecnt,
			            axisLabel: {
			                formatter: '{value}'
			            }
			        },
			        {
			            type: 'value',
			            name: '金额(单位:万元)',
			            min: 0,
			            max: (ysaleround*5).toFixed(2),
			            interval: ysaleround,
			            axisLabel: {
			                formatter: '{value}'
			            }
			        }
			    ],
			    series: [
			        {
			            name:'售票数量',
			            type:'bar',
			            data:datainfo.salecntlist,
			            
			        },
			        {
			            name:'售票金额',
			            type:'bar',
			            yAxisIndex: 1,
			            data:datainfo.saleroundlist,
			           
			        }
			    ]
			};
			myChart.setOption(option);
			
			var myChart1 = echarts.init(document.getElementById('main1'));
			var option1 = {
		        title:{
		         text:'代理人购票情况',
		         margin:20,
		         top:10,
		         left:'center',
		            textStyle: {
		            color: '#000',
		            fontStyle: 'normal',
		            fontFamily: '微软雅黑',
		            fontSize: 20,
		            margin:40,
		        }
		     },
		    tooltip: {
		        trigger: 'axis',
		        axisPointer: {type: 'cross'}
		    },
		    grid: {
	            right: '15%',
	            top:80
	           
	        },
		     dataZoom:[
		                    {   show:true,
		                        height:25,
		                        xAxisIndex: [0],
		                        bottom:10,
		                        type: 'slider',
		                        startValue: 0,
		                        endValue:10,
		                        handleIcon: 'path://M306.1,413c0,2.2-1.8,4-4,4h-59.8c-2.2,0-4-1.8-4-4V200.8c0-2.2,1.8-4,4-4h59.8c2.2,0,4,1.8,4,4V413z',
		                        handleSize:'110%',
		                        handleStyle: {
		                            color:'#9B4E4E'
		                        }
		                     },
		                     {
		                         show:true,
		                         type: 'inside',
		                         height:15,
		                         startValue: 0,
		                         endValue:10
		                     }
		                     ,
		                     {
		                         show: true,
		                         yAxisIndex: [0,1],
		                         filterMode: 'empty',
		                         width: 30,
		                         height: '70%',
		                         showDataShadow: false,
		                         right: '3%'
		                     }
		                    ],
		    toolbox: {
		        feature: {
		            dataView: {show: true, readOnly: false},
		            magicType: {show: true, type: ['line', 'bar']},
		            restore: {show: true},
		            saveAsImage: {show: true}
		        }
		    },
		    legend: {
		        left:20,
		        top:10,
		        data:['购票数量','购票金额']
		    },
		    xAxis: [
		        {
		            type: 'category',
		            data: datainfo.agentlist
		        }
		    ],
		    yAxis: [
		        {
		            type: 'value',
		            name: '数量(单位:张)',
		            min: 0,
		            max: ybuycnt*5,
		            interval: ybuycnt,
		            axisLabel: {
		                formatter: '{value}'
		            }
		        },
		        {
		            type: 'value',
		            name: '金额(单位:万元)',
		            min: 0,
		            max: (ybuyround*5).toFixed(2),
		            interval: ybuyround,
		            axisLabel: {
		                formatter: '{value}'
		            }
		        }
		    ],
		    series: [
		        {
		            name:'购票数量',
		            type:'bar',
		            data:datainfo.buycntlist,
		           
		        },
		        {
		            name:'购票金额',
		            type:'bar',
		            yAxisIndex: 1,
		            data:datainfo.buyroundlist,
		           
		        }
		    ]
		};
		myChart1.setOption(option1);
			}
		});
	}
	
</script>

</body>
</html>
